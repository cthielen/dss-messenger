<div id="messages" class="span9"></div>

<script type="text/javascript">
  $(function() {
    // DssMessenger is the app name
    window.router = new DssMessenger.Routers.MessagesRouter({messages: <%= @messages.to_json(include: [:recipients, :messenger_events, :impacted_services]).html_safe -%>});
    Backbone.history.start();
  });
console.log (<%= @messages.to_json(include: [:recipients, :messenger_events, :impacted_services]).html_safe -%>);
</script>
<div class="span3">
	<div class="well">
		<a href="#/new" class="btn btn-primary btn-large btn-block">New Message</a>
	</div>
	<div class="well">
		<h3>Filters:</h3>
		<h4>Impacted Services</h4>
	    <% for impacted_service in ImpactedService.find(:all) %>
		<div>
		  <%= check_box_tag "message[impacted_service_ids][]", impacted_service.id %>
		  <%= impacted_service.name %>
		</div>
		<% end %>
		<h4>Events</h4>
	    <% for messenger_event in MessengerEvent.find(:all) %>
		<div>
		  <%= check_box_tag "message[messenger_event_ids][]", messenger_event.id %>
		  <%= messenger_event.description %>
		</div>
		<% end %>
	</div>
</div>
